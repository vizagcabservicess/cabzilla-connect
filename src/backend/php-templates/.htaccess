
# Prevent caching for API endpoints
<IfModule mod_headers.c>
  <FilesMatch "\.(php)$">
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
  </FilesMatch>
</IfModule>

# Enable CORS
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, OPTIONS, PUT, DELETE"
  Header set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# Handle Authorization header
RewriteEngine On
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

# Prevent caching for JSON responses
<FilesMatch "\.json$">
  <IfModule mod_headers.c>
    Header set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header set Pragma "no-cache"
    Header set Expires "Wed, 11 Jan 1984 05:00:00 GMT"
  </IfModule>
</FilesMatch>

# Return 404 for any sensitive files
<FilesMatch "(config\.php|\.env|\.*sql)$">
  Order allow,deny
  Deny from all
</FilesMatch>

# PHP settings for better security and performance
<IfModule mod_php7.c>
  php_flag display_errors Off
  php_flag log_errors On
  php_value max_execution_time 300
  php_value memory_limit 256M
  php_value post_max_size 50M
  php_value upload_max_filesize 20M
</IfModule>
