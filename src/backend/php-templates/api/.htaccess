
# Enable rewrite engine
RewriteEngine On

# Parse API routes to PHP files
RewriteRule ^signup$ signup.php [L]
RewriteRule ^login$ login.php [L]
RewriteRule ^user/dashboard$ user/dashboard.php [L]
RewriteRule ^booking/create$ book.php [L]
RewriteRule ^book$ book.php [L]
RewriteRule ^book/edit/([0-9]+)$ book-edit.php?id=$1 [L]
RewriteRule ^admin/bookings$ admin/bookings.php [L]
RewriteRule ^fares/tours$ fares/tours.php [L]
RewriteRule ^fares/vehicles$ fares/vehicles.php [L]
RewriteRule ^admin/fares/update$ admin/fares-update.php [L]
RewriteRule ^admin/km-price/update$ admin/km-price-update.php [L]
RewriteRule ^send-receipt$ send-receipt.php [L]
RewriteRule ^receipt/([0-9]+)$ receipt.php?id=$1 [L]

# Custom error handling for API
ErrorDocument 500 '{"status":"error","message":"Internal Server Error","code":500}'
ErrorDocument 404 '{"status":"error","message":"Not Found","code":404}'
ErrorDocument 403 '{"status":"error","message":"Forbidden","code":403}'

# Disable caching for API endpoints
<IfModule mod_headers.c>
    Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</IfModule>

# Set content type
<FilesMatch "\.(php)$">
    Header set Content-Type "application/json"
</FilesMatch>

# Enable CORS
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
    Header always set Access-Control-Max-Age "3600"
</IfModule>

# Handle OPTIONS method for CORS preflight
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule .* - [R=200,L]

# Disable PHP error display in response
php_flag display_errors off
php_value error_reporting 0
